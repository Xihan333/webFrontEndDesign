

# 项目报告

[TOC]



## 第一部分 项目简介

### 1.系统总体功能介绍

**总体功能需求：**

1.  用户管理（10分）：用户注册、忘记密码（通过邮件发送验证码）、重置密码（检查验证码）、用户信息维护（修改密码、个人信息、邮箱等）。支持管理员、教师、学生三种角色。

2. 前端展示框架（5分）：支持二级菜单导航、系统logo、个人头像，版权说明分区布局显示

3. 基本信息维护（5分）：学生和教师网页中相关展示的个人信息的维护

4. 课程中心（10分）：课程管理、选课管理、成绩管理等。

5. 学工管理（10分）：社会实践、课外活动、成果奖励、学生互评

6.  学生主页（15分）：个人简介、照片、博客、用户画像（数据统计和行为分析）。

7.  教师主页（5分）：个人简介、照片、研究方向、讲授课程、论文著作等。

提示：课程功能可参考学院的类似系统。

**非功能性需求：**

1. 用户体验（10分）：界面美观、布局协调、导航便捷（多级导航）、操作流畅。可用CSS样式、UI框架（如Element-UI）、图片、动画、音乐、视频、表格插件、富文本编辑插件等方式完善设计。

2. 程序质量（10分）：具备输入校验（必填、数值/文本类型、格式）、系统运行稳定（遇到异常不崩溃、有反馈）、会话管理正确（有登录状态和权限校验，刷新页面后能够保持会话）、验证码。

3. 数据设计（10分）：表和字段命名规范、约束健全（主键、唯一、非空等）、关系完备（通过外键实现，可导出E-R图）。

4. 文档质量（10分）：实验报告包括项目简介、需求分析、架构设计、数据设计、使用说明等内容。

### 2.开发环境介绍

#### 语言开发集成环境：

- IntelliJ IDEA
- VS code

#### 硬件环境：

- Windows 11 X64环境

### 3.开发技术介绍

####  （1）前端:

- Vue

  Vue 是一种用于构建用户界面的渐进式JavaScript框架。它易于上手且灵活，特别适合单页面应用（SPA）。Vue 强调声明式渲染和组件化架构，这意味着你可以通过简单地描述界面应该呈现的状态来构建复杂的界面。此外，Vue 的生态系统提供了路由、状态管理等强大的功能，使得开发大型应用变得更加高效。

- Element-plus

  Element-plus 是一款基于 Vue 3 的桌面端组件库，它提供了一整套丰富的、可重用的组件，如表格、对话框、菜单等，极大地加速了基于 Vue 的界面开发过程。Element-plus 的设计风格简洁、现代，且易于自定义，能够帮助开发者快速构建美观且功能丰富的应用界面。

- JavaScript

  JavaScript 是一种高级编程语言，用于网页开发、服务器端开发等多个领域。作为一种解释型语言，JavaScript 主要用于添加交互性和动态效果到网页上。它是万维网的三大核心技术之一，与HTML和CSS共同工作。JavaScript 支持面向对象、命令式及函数式编程风格，灵活性和广泛的应用使其成为开发者的首选。

- TypeScript

  TypeScript 是 JavaScript 的一个超集，它在 JavaScript 的基础上添加了静态类型检查。这意味着开发者可以在代码中定义变量和函数的类型，这样就可以在编译时捕获许多潜在的错误。TypeScript 的类型系统是可选的和灵活的，可以为大型项目带来更高的稳定性和可维护性。它完全兼容JavaScript，并且可以利用JavaScript的丰富生态系统。

- Echarts

  Echarts 是一个使用 JavaScript 实现的开源可视化库。它提供了丰富的图表类型，如折线图、柱状图、散点图等，非常适合于数据的图形化表示。Echarts 易于上手，支持高度自定义，并且能够轻松地嵌入到网页中。其优秀的交互性和出色的性能使其成为数据可视化项目的优选工具。 

- v-md-editor

  v-md-editor 是一款基于 Vue 的 Markdown 编辑器，它为用户提供了一个易于使用的界面来编写和预览Markdown文档。v-md-editor 支持多种扩展和自定义配置，例如代码高亮、主题更换等，能够满足多样化的编辑需求。此外，它的响应式设计保证了在不同设备上的良好体验。

- Axios

  Axios 是一个基于 Promise 的 HTTP 客户端，用于浏览器和 node.js。它使得发送 HTTP 请求变得简单和灵活。Axios 具有广泛的特性，包括从浏览器中创建 XMLHttpRequests 和从 node.js 发出 http 请求、支持 Promise API、拦截请求和响应、转换请求和响应数据等。

#### （2）后端：

- Spring Boot

  项目使用Spring Boot作为后端开发框架，Spring Boot是由Pivotal团队提供的一套开源框架，可以简化spring应用的创建及部署。作为一个强大的开发框架，它不仅提供了快速启动器和自动配置，还整合了大量的开发工具和库。这使得开发者能够更专注于业务逻辑的实现，而不必花费大量时间在配置和集成上。同时，Spring Boot 的内置容器简化了应用程序的部署流程，使得团队在项目开发时更加便捷。

- Spring Data Jpa

  Spring Data JPA： JPA（Java Persistence API）即java持久化API，是spring提供的一款对于数据访问层（Dao层）的框架，为数据库操作提供了一种简单的抽象方式，将 Java 对象与数据库表之间建立映射关系。使用Spring Data JPA，只需要按照框架的规范提供dao接口，不需要实现类就可以完成数据库的增删改查、分页查询等方法的定义，不仅提供了更加面向对象的数据库操作方式，还简化了数据持久化的代码编写，减少了手动编写 SQL 查询语句的工作量。

- Spring Security

  Spring Security 是一个功能强大的安全框架，为应用程序提供了全方位的安全性保障。它支持身份验证、授权、攻击防范等功能，能够有效地保护系统免受各种恶意攻击，并管理用户的权限和访问控制。

- Redis

  Redis 是一种高性能的键值存储数据库，广泛用于临时数据的存储和缓存。它不仅具有出色的读写性能，还支持多种数据结构，如字符串、哈希、列表等。在本项目中，利用 Redis 存储邮箱验证码信息，并设置有效期为5分钟，为用户身份验证提供了便捷而高效的解决方案。

- Lombok

  Lombok 是一款方便实用的 Java 库，通过注解来消除样板代码，例如生成 getter、setter、toString 等方法。这种自动生成代码的方式极大地简化了开发流程，让团队成员可以更专注于业务逻辑的实现，而不必为常规的代码编写而烦恼。

## 第二部分 需求分析

### 产品功能信息结构图

![mmexport1701692218428(1)](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312281446013.png)

### 需求描述

#### 通用功能

1. **登录注册**

​	三种角色的登录，登录成功换页，登录失败提示

​	教师与学生注册，通过邮箱发送验证码，密码强度判断，注册成功后跳转至登录页面，失败提示

​	找回密码（邮件验证码），重置密码

​	前端框架展示：二级菜单导航，系统logo，个人头像，版权说明，分区布局显示

2. **基本信息维护**

   密码，邮箱，手机，地址、身份证号，个人简介

   \* 密码复杂性的要求

   *身份证号合法性判断

   *手机号前三位是否合法

   *个人简介可Markdown编辑

#### 学生端

1. 个人主页

   点击照片可进行修改修改（上传、缩放、存储方法）

   基本信息展示

   数据统计和行为分析：根据学生GPA以及分数数据进行分析并绘制图表

   奖励/实践清单：分栏展示该学生经审核通过的成果与社会实践

   个人简介：使用Markdown预览查看该学生简介

2. 课程中心

   - 选课系统

     选课开启时间内可选择课程及退课操作

     冲突检测：上课时间、剩余容量是否冲突

     条件筛选：通过课程名、课序号、教师、类型、节次进行筛选

   - 查看课表

     将已选课程呈现在学生课表上，按类型赋予不同颜色

     悬停显示课程详细信息

   - 查看成绩

     根据教师端后台赋分计算总成绩并展示

     查看该课程在班级内的排名

3. 学工管理

   - 社会实践（主题、名称、时间、地点、成果、审核状态）

     可对时间以及审核状态进行排序或筛选

   - 课外活动（主题、时间、地点、介绍）

   - 成果奖励（名称、类别、级别、时间、内容、审核状态）

   - 学生互评

     根据班级查看本班同学名单

     可查看对应同学主页，并对其进行匿名评价

     查看历史评论列表（查看内容和删除）

     查看对我的评论（仅显示时间和内容）

4. 博客系统

   显示所有文章（标题、摘要、发布时间、作者）

   查看我发布的文章（同上）

   点击文章可查看详细内容（Markdown渲染）

   对我的文章进行修改和删除操作

   发布新文章（Markdown编辑、标题、摘要、标签）

#### 教师端

1. 个人主页

   点击照片可进行修改修改（上传、缩放、存储方法）

   基本信息展示

   发布论文列表

   个人简介：使用Markdown预览查看该教师简介

2. 课程中心

   - 查看课程

     查看该教师任教课程信息

   - 成绩管理

     查看选课学生名单并对其成绩进行编辑操作（可对学生及课程进行筛选）

3. 论文管理（名称、作者、发表时间）

   实现基本增删改查

#### 管理端

1. 学科管理

   对学科进行统筹管理，包括：开设单位、年级、名称、课序号、学时、学分、类型、介绍

   实现基本增删改查

2. 课程管理

   通过课序号关联课程与教师，实现同一科目多人任教

   包括：教师工号、教师名称、课容量、上课时间、地点

   实现基本增删改查

   选课状态按钮管理

3. 人员管理

   - 学生管理（姓名、学号、性别等基本信息）

     实现基本增删改查

   - 教师管理（姓名、工号、性别等基本信息）

     实现基本增删改查

   - 班级管理

     班级基本信息（名称、年级、学院）并实现增删改查

     查看班级学生列表（学号、姓名、性别等基本信息）

     查看未分配班级的同学（基本信息）并为其分配现有班级

4. 学工管理

   - 社会实践（学生姓名、学号、主题、名称、时间、地点、成果、审核状态）

     可对时间以及审核状态进行排序或筛选

     对社会实践条目进行审核

   - 成果奖励（学生姓名、学号、名称、类别、级别、时间、内容、审核状态）

     同上

   - 学生互评（评价人与被评价人学号、姓名、评价内容、评价时间）

     对其进行查看和删除操作

## 第三部分 架构设计



## 第四部分 数据设计



## 第五部分 使用说明

### 邮箱注册及找回密码

验证码存储在本地运行的redis中（设置5min有效期，5min后验证码会失效），若要使用该功能，需在本地运行redis，请设置端口号及密码如下：

```
port: 6379
password: 
```

*redis使用教程：*

1. 安装并运行redis （可以在本地直接安装，也可以使用docker运行redis）

   在docker中使用redis：

   ```shell
   docker pull redis:latest
   docker run -itd --name redis -p 6379:6379 redis
   ```

2. 修改密码：

```shell
CONFIG SET requirepass "your_new_password"
```

若使用docker：

```shell
docker exec -it redis redis-cli
CONFIG SET requirepass "your_new_password"
```

3. 运行该项目即可

若需查看redis存储内容，可使用如Another Redis Desktop等可视化工具

也可以修改后端项目application.yml文件中的redis配置ip地址为自己的服务器ip，redis端口号，密码

## 第六部分 特色功能

想了想，感觉可能比较特色的功能（指可以写一堆文字来凑字数），亟待补充

### 邮箱校验&验证码

### 学科和课程（开关选课）

### 班级管理

学生端手动修改班级、专业、年级等固定信息，容易导致分班混乱难以控制，班级和专业将沦为单纯的字符串；同时，管理员在学生管理界面无法便捷地为每一位学生确定班级和专业，多次输入容误差概率显著提升。为了避免这些现象，将班级真正地利用起来并实现统一的管理，我们增加了班级管理这一模块。

班级Model部分如下：

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@Entity
@Table(	name = "clazz",
        uniqueConstraints = {
        })
public class Clazz {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Integer clazzId;

    private String clazzName;

    @ManyToOne
    @JoinColumn(name = "grade_id")
    private Grade grade;

    @OneToOne
    @JoinColumn(name="capmus_id")
    private Campus campus; //学院
}
```

前端展示时，页面完成挂载后调用`getClazzOptionItemListByGradeId`获取班级数据，并呈现在表格中

![image-20231230011237361](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300112549.png)

接口代码如下：

```java
 public DataResponse getClazzOptionItemListByGradeId(DataRequest dataRequest) {
       Integer gradeId=dataRequest.getInteger("gradeId");
       if(gradeId == null){
           List<Clazz> sList = clazzRepository.findAll();
           return CommonMethod.getReturnData(getClazzMapList(sList));
       }
       List<Clazz> sList = clazzRepository.findClazzListByGradeGradeId(gradeId);
       return CommonMethod.getReturnData(getClazzMapList(sList));
  }
```

前端请求部分如下：

```javascript
onMounted(async ()=> {
    updateTableData()
})

const updateTableData = async () => {
  const res = await request.post('/clazz/getClazzOptionItemListByGradeId',{
    data:{
      gradeId:'' //获取所有班级
    }
  })
  tableData.value = res.data.data
  filterTableData.value = res.data.data
}
```

新增班级时，通过下拉框选择班级所属学院和年级，极大降低了手动输入带来的误差，调用`clazzEditSave`接口完成新增操作。

![image-20231230011836910](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300118962.png)

接口代码如下：

```java
public DataResponse clazzEditSave(DataRequest dataRequest) {
        Integer clazzId = dataRequest.getInteger("clazzId");  //获取clazz_id值
        Map clazz = dataRequest.getMap("clazz");
        String clazzName = CommonMethod.getString(clazz,"clazzName");
        Integer gradeId = CommonMethod.getInteger(clazz,"gradeId");
        Integer campusId = CommonMethod.getInteger(clazz,"campusId");
        Clazz a = null;
        Optional<Clazz> op;
        if(clazzId != null) {
            op= clazzRepository.findByClazzId(clazzId);  //查询对应数据库中主键为id的值的实体对象
            if(op.isPresent()) {
                a = op.get();
            }
        }
        if(a == null){
            clazzId = getNewClazzId(); //获取Clazz新的主键
            a = new Clazz();
            a.setClazzId(clazzId);
        }
        Optional<Grade> og = gradeRepository.findByGradeId(gradeId);
        Grade grade;
        if(og.isPresent()){
            grade = og.get();
        }else{
            return CommonMethod.getReturnMessageError("年级不存在！");
        }
        a.setGrade(grade);
        a.setClazzName(clazzName);
        Optional<Campus> oc = campusRepository.findByCampusId(campusId);
        Campus campus;
        if(oc.isPresent()){
            campus = oc.get();
        }else{
            return CommonMethod.getReturnMessageError("学院不存在！");
        }
        a.setCampus(campus);
        clazzRepository.saveAndFlush(a);//插入新的Clazz记录
        return CommonMethod.getReturnData(a.getClazzId(),"修改或新增成功");  // 将ClazzId返回前端
    }
```

点击查看未分配班级同学按钮，即可查看暂未分班的学生（数据库中clazz_id为空），调用`getNoClazzStudents`接口获取学生名单，同时调用`getClazzOptionItemListByGradeId`接口获取现有班级列表

![image-20231230012721873](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300127914.png)

为避免出现同班级名称不同年级的情况，在下拉框中将`label`调整为`gradeName`与`clazzName`的组合

![image-20231230012939242](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300129322.png)

```vue
 <div class="dialogContent">
        <div class="clazzName">
          <p>选择班级</p>
          <el-select v-model="clazzId" value-key="id"
          placeholder="请选择班级" clearable @change="changeSelect">
              <el-option
              v-for="item in clazzData"
                :key="item.clazzId"
                :label="item.gradeName+' '+item.clazzName"
                :value="item.clazzId"
              />    
        </el-select>
       </div>
</div>
```

点击班级管理首页的班级名称，即可跳转至班级学生列表：

![image-20231230013252572](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300132687.png)

同样，在页面挂载结束后，像后端发送请求，调用接口`getStudentOptionItemListByClazzId`，通过store实现不同页面间的数据传递。

删除班级时，调用`clazzDelete`接口，将该班级中的所有学生`clazzId`清空，即恢复到无班级状态

```java
public DataResponse clazzDelete(DataRequest dataRequest) {
        Integer clazzId = dataRequest.getInteger("clazzId");  //获取clazz_id值
        Clazz a = null;
        Optional<Clazz> op;
        if(clazzId != null) {
            op= clazzRepository.findByClazzId(clazzId);  //查询对应数据库中主键为id的值的实体对象
            if(op.isPresent()) {
                a = op.get();
            }else{
                return CommonMethod.getReturnMessageError("班级不存在！");
            }
        }
        if(a != null) {
            List<Student> studentList = studentRepository.findStudentListByClazzClazzId(clazzId);
            for(Student s: studentList){
                s.setClazz(null);
            }
            clazzRepository.delete(a);//删除该班级
        }
        return CommonMethod.getReturnMessageOK("删除成功");  //通知前端操作正常
    }
```

通过班级管理这一功能，将学生与年级、学院有效对应，同时为后续的互评功能奠定基础，使项目逻辑更加严密。

### echarts图表（虽然大家都用但还是特色！）

为了直观展现用户动态和进行行为分析，兼顾学生主页的丰富性和美观需求，特引入`echarts`库进行统计图表的绘制。

1. 配置与导入：

   通过`npm`获取`echarts`，这里获取特定版本

   ```
   npm install echarts@4.9.0 --save
   ```

   在main.js中增加设置

   ```javascript
   //echart
   import * as echarts from 'echarts';
   app.config.globalProperties.$echarts = echarts;
   ```

2. 在`Homepage.vue`中使用`echarts`

   学生主页共有两个图表，一个是GPA占比的饼状图，另一个为成绩等级数量的玫瑰图，下面是这两张图表的`js`部分：

   ![image-20231230021119048](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300211089.png)

   ```javascript
   //饼状图
   const userInfo = ref({
       //其他属性
       gpa:'',
   })
   const dom1 = document.getElementById('myChart');
       const myChart = echarts.init(dom1); // 初始化echarts实例
       const option1 = {
         series: [{
             color:["#6FB6C1","#e6e6e6"],
             type: 'pie',
             data: [
                 {
                 value: userInfo.value.gpa,
                 name: 'GPA:'+ userInfo.value.gpa
                 },
                 {
                 value: 5-userInfo.value.gpa,
                   name: '满分5'
                   },
               ],
               radius: '50%'
           }]
       };
     // 设置实例参数
     myChart.setOption(option1);
   
   ```

   ![image-20231230021244157](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300212210.png)

   ```javascript
   //玫瑰图 
   const dom2 = document.getElementById('scoreChart');
       const scoreChart = echarts.init(dom2);
       const option2 = {
           series: [{
           color:["#6FB6C1","#a094c3","#ccdead","#dbc4a7","#c16f6f"],
           type: 'pie',
           data: markList.value,
           roseType: 'area'
           }
       ]};
       // 设置实例参数
       scoreChart.setOption(option2);
   ```

   由于后端所传参数markList格式与绘图所需data一致，此处便直接将其值赋给data

   ```
   markList=[
       {name: '优：2', value: 2},
       {name: '良：4', value: 4},
       {name: '中：3', value: 3},
       {name: '及格：1', value: 1},
       {name: '不及格：0', value: 0}
   ]
   ```


### 无孔不入的Markdown

为了实现富文本编辑，丰富可展示信息，以及美化界面，决定引入基于`Vue`开发的轻量级`Markdown`编辑器组件`v-md-editor`，下面是详细介绍。

1. 导入和配置

   通过`npm`下载

   ```
   # use npm
   npm i @kangc/v-md-editor -S
   ```

   若出现报错依赖冲突或`Uncaught TypeError: Cannot read properties of undefined (reading 'config')`等，在命令行运行如下命令即可

   ```
   npm i @kangc/v-md-editor@next -S --legacy-peer-deps
   ```

   在vue中引入轻量版编辑器和预览组件

   ```javascript
   // If you want to use Md-editor, import it.
   import VMdEditor from '@kangc/v-md-editor';
   import '@kangc/v-md-editor/lib/style/base-editor.css';
   import githubTheme from '@kangc/v-md-editor/lib/theme/github.js';
   import '@kangc/v-md-editor/lib/theme/style/github.css';
   
   // highlightjs
   import hljs from 'highlight.js';
   
   VMdEditor.use(githubTheme, {
     Hljs: hljs,
   });
   
   //preview
   import VMdPreview from '@kangc/v-md-editor/lib/preview';
   import '@kangc/v-md-editor/lib/style/preview.css';
   
   VMdPreview.use(githubTheme, {
     Hljs: hljs,
   });
   
   const app = createApp(/*...*/);
   
   app.use(VMdEditor);
   app.use(VMdPreview);
   ```

2. 编辑器组件的使用

   ![image-20231230023756472](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300237607.png)

   ```vue
   <template>
     <v-md-editor v-model="markdown" height="700px" 
               placeholder="# 记录创作灵感 & 美好生活 #"></v-md-editor>
   </template>
   <scrpt>
   const markdown = ref('')
   </scrpt>
   ```

3. 预览组件的使用

   ![image-20231230024209508](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300242665.png)

   ```vue
   <template>
   	<v-md-preview :text="text" class="content"></v-md-preview>
   </template>
   <script>
   	const text = blogInfo.value.content
   </script>
   ```



### 美美嘟课表

### 冲突判断&格式校验

身份证号、手机号、选课时间等冲突

### 学生互评

查看本班同学，查看对应人的主页（如何获取信息）



下面是一些细碎的小部件

### 查询功能的实现（filter方法）

### 数据分页（pagination）

### 整体页面布局

### store 传参（以班级管理为例）

点击班级管理首页班级列表中的名称，即可跳转至对应班级的学生名单页面

`ClazzManage.vue`

![image-20231230011237361](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300112549.png)

`classmate.vue`

![image-20231230013252572](https://cdn.jsdelivr.net/gh/Xihan333/imgRep/202312300132687.png)

具体实现方法如下：

```javascript
// @/stores/app.ts
export const useAppStore = defineStore('app', () => {
  /* 其他数据 */
  const classmate = ref({
    clazzId:"",
    clazzName:""
  })
  return {
    classmate
  }
})
```

```vue
<!--  @/views/admin/ClazzManage.vue -->
<template>
   <!-- -->
    <el-table-column prop="clazzName" label="班级名称" width="auto" align="center">
              <template #default="scope">
                <a href="javascript:" @click="handleClickName(scope)">{{ scope.row.clazzName }}</a>
              </template>
    </el-table-column>
	<!-- -->
</template>
<script>
    import { useAppStore } from '../../stores/app.ts'
    import router from "~/router";
    const store = useAppStore()
	const handleClickName = (clazz) => {
      console.log(clazz.row.clazzName)
      store.classmate = clazz.row
      console.log(store.classmate)
      router.push('classmate')
    }
    
</script>

```

```vue
<!--  @/views/admin/classmate.vue -->
<script>
import { useAppStore } from '../../stores/app.ts'
import { storeToRefs } from 'pinia'

const store = useAppStore()

const { classmate } = storeToRefs(store);
const className = classmate.value.clazzName
const tableData = ref([])
const updateTableData = async () => {
  console.log(classmate.value.clazzName)
  const res = await request.post('/student/getStudentOptionItemListByClazzId',{
    data:{
        clazzId:classmate.value.clazzId
    }
  })
  tableData.value = res.data.data
}
</script>
```



